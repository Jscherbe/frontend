////
/// @group scroll-slider
////

@use "vars";
@use "sass:map";
@use "../element";
@use "../color";
@use "../utils";
@use "../layout";
@use "../breakpoint";
@use "../selector";


// Reference:
// - https://web.dev/css-scroll-snap/

/// Module Settings
/// @type Map
/// @param {} container  ["container"]
/// @param {} background-color  [false]
/// @param {} margin-top  [1rem]
/// @param {} margin-bottom  [3rem]
/// @param {} padding-top  [0]
/// @param {} padding-bottom  [0]
/// @param {} button-indent  [1.5rem]
/// @param {} button-indent-small  [0.5rem]
/// @param {} button-size  [3rem]
/// @param {} button-font-size  [1.35rem]
/// @param {} button-color  [color.get("type")]
/// @param {} button-border  [2px solid white]
/// @param {} button-border-radius  [50%]
/// @param {} button-background-color  [white]
/// @param {} button-box-shadow  [element.get("box-shadow")]
/// @param {} button-color-hover  [color.get("link")]
/// @param {} button-border-color-hover  [white]
/// @param {} button-background-color-hover  [white]
/// @param {} button-icon-offset-x  [false]
/// @param {} button-icon-offset-y  [false]
/// @param {} containers  [("container",)]
/// @param {} prefix ["scroll-slide"]

/// Config options

$config: (
  "container" : "container",
  "background-color" : false,
  "margin-top" : 1rem,
  "margin-bottom" : 3rem,
  "padding-top" : 0,
  "padding-bottom" : 0,
  "button-indent" : 1.5rem,
  "button-indent-small" : 0.5rem,
  "button-size" : 3rem,
  "button-font-size" : 1.35rem,
  "button-color" : color.get("type"),
  "button-border" : 2px solid white,
  "button-border-radius" : 50%,
  "button-background-color" : white,
  "button-box-shadow" : element.get("box-shadow"),
  "button-color-hover" : color.get("link"),
  "button-border-color-hover" : white,
  "button-background-color-hover" : white,
  "button-icon-offset-x" : false,
  "button-icon-offset-y" : false,
  "containers" : ("container",),
  "prefix": "scroll-slider"
) !default;

/// Change modules $config
/// @param {Map} $changes Map of changes
/// @example scss - General example, replace module-name with module's name
///   @include module-name.set(( "property" : value ));

@mixin set($changes) {
  $config: map.merge($config, $changes) !global;
}

/// Get a config option
/// @param {Map} $name Name of property
///   @include module-name.get("property");

@function get($name) {
  @return utils.require-map-get($config, $name, "scroll-slider [config]");
}

@mixin styles {
  $prefix: selector.class(get("prefix"));
  
  #{ $prefix } {
    position: relative; // for controls
    background-color: get("background-color");
    margin: get("margin-top") 0 get("margin-bottom") 0;
  }
  #{ $prefix }--cards {
    #{ $prefix }__slide {
      margin-right: 1.35rem;
      // display: flex;
      > .card {
        width: 100%;
        max-width: none;
        height: calc(100% - 2rem);
        margin: 1rem 0 1rem 0;// For shadows
      }
    }
    #{ $prefix }__slide--empty {
      margin-right: 0;
    }
  }
  #{ $prefix }__track {
    display: flex;
    overflow-x: auto;
    scroll-behavior: smooth;
    scroll-snap-type: x mandatory;
    // scroll-padding-left: calc(((100vw - vars.$site-max-width) / 2) + vars.$site-margin);
    // switch below to a modifier (like #{ $prefix }--in-container, #{ $prefix }--in-container-large-x) Default is container
    @include layout.match-container-margin("scroll-padding-left", get("container"));
    // scroll-padding-right: 1rem;
    // Hide scrollbars
    -ms-overflow-style: none; /* for Internet Explorer, Edge */
    scrollbar-width: none; /* for Firefox */
    &::-webkit-scrollbar {
      display: none; /* for Chrome, Safari, and Opera */
    }
    // padding: 1rem;
    // Add space to end of list
    // &:after {
    //   content: "\00a0";
    //   display: block;
    //   width: 1rem;
    //   height: 100%;
    //   flex: 0 0 1rem;
    // }
  }
  #{ $prefix }__slide {
    
    flex: 0 0 450px;
    max-width: 90vw;
    scroll-snap-align: start;
    $container: layout.get-container("container", "small");
    @include breakpoint.max("small") {
      $pad: layout.get-container-padding-x("container", "small");
      max-width: none;
      flex-basis: calc(100vw - ($pad * 2) - var(--ulu-scrollbar-width));
    }
    // margin-right: 1rem;
  }
  #{ $prefix }__slide--empty {
    scroll-snap-align: none;
    // flex-basis: calc(((100vw - vars.$site-max-width) / 2) + vars.$site-margin);
    @include layout.match-container-margin("flex-basis", get("container"));
    margin-right: 0;
    // @include ulu.breakpoint-max("small") {
    //   &:last-child {
    //     display: none;
    //   }
    // }
  }
  #{ $prefix }__controls {
    list-style: none !important;
    padding: 0;
  }
  .OverflowScroller__control-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
  }
  @if get("button-icon-offset-y") {
    .OverflowScroller__control-icon {
      margin-top: get("button-icon-offset-y");
    }
  }
  .OverflowScroller__control-button--previous {
    left: get("button-indent");
    @if get("button-icon-offset-x")  {
      .OverflowScroller__control-icon {
        margin-left: get("button-icon-offset-x");
        
      }
    }
  }
  .OverflowScroller__control-button--next {
    right: get("button-indent");
    @if get("button-icon-offset-x")  {
      .OverflowScroller__control-icon {
        margin-right: get("button-icon-offset-x");
      }
    }
  }
  @include breakpoint.max("small") {
    .OverflowScroller__control-button--previous {
      left: get("button-indent-small");
    }
    .OverflowScroller__control-button--next {
      right: get("button-indent-small");
    }
  }
}