<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>deprecated/mini-collapsible-popper-positioning.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="NodeDataStore.html">NodeDataStore</a></li><li><a href="module.html#.exports">exports</a></li><li></li><li><a href="module.exports_module.exports.html">exports</a></li><li><a href="module-css-breakpoint.CssBreakpoints.html">CssBreakpoints</a><ul class='methods'><li data-type='method'><a href="module-css-breakpoint.CssBreakpoints.html#at">at</a></li><li data-type='method'><a href="module-css-breakpoint.CssBreakpoints.html#getBreakpoint">getBreakpoint</a></li><li data-type='method'><a href="module-css-breakpoint.CssBreakpoints.html#update">update</a></li></ul></li><li><a href="module-css-breakpoint-Breakpoint.html">Breakpoint</a><ul class='methods'><li data-type='method'><a href="module-css-breakpoint-Breakpoint.html#_setDirection">_setDirection</a></li><li data-type='method'><a href="module-css-breakpoint-Breakpoint.html#max">max</a></li><li data-type='method'><a href="module-css-breakpoint-Breakpoint.html#min">min</a></li><li data-type='method'><a href="module-css-breakpoint-Breakpoint.html#only">only</a></li><li data-type='method'><a href="module-css-breakpoint-Breakpoint.html#remove">remove</a></li></ul></li><li><a href="module-css-breakpoint-BreakpointDirection.html">BreakpointDirection</a><ul class='methods'><li data-type='method'><a href="module-css-breakpoint-BreakpointDirection.html#_call">_call</a></li><li data-type='method'><a href="module-css-breakpoint-BreakpointDirection.html#add">add</a></li><li data-type='method'><a href="module-css-breakpoint-BreakpointDirection.html#change">change</a></li><li data-type='method'><a href="module-css-breakpoint-BreakpointDirection.html#getHandlers">getHandlers</a></li><li data-type='method'><a href="module-css-breakpoint-BreakpointDirection.html#remove">remove</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-css-breakpoint.html">css-breakpoint</a></li><li><a href="module-events.html">events</a><ul class='methods'><li data-type='method'><a href="module-events.html#.dispatch">dispatch</a></li><li data-type='method'><a href="module-events.html#.getName">getName</a></li></ul></li><li><a href="module-file-save.html">file-save</a></li></ul><h3>Global</h3><ul><li><a href="global.html#cacheTrigger">cacheTrigger</a></li><li><a href="global.html#close">close</a></li><li><a href="global.html#config">config</a></li><li><a href="global.html#createOptions">createOptions</a></li><li><a href="global.html#destroy">destroy</a></li><li><a href="global.html#find">find</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#log">log</a></li><li><a href="global.html#logError">logError</a></li><li><a href="global.html#logWarning">logWarning</a></li><li><a href="global.html#newContainer">newContainer</a></li><li><a href="global.html#newModal">newModal</a></li><li><a href="global.html#pauseVideos">pauseVideos</a></li><li><a href="global.html#popperPositioning">popperPositioning</a></li><li><a href="global.html#prepVideos">prepVideos</a></li><li><a href="global.html#set">set</a></li><li><a href="global.html#setModalId">setModalId</a></li><li><a href="global.html#setPositionClasses">setPositionClasses</a></li><li><a href="global.html#setup">setup</a></li><li><a href="global.html#setupModal">setupModal</a></li><li><a href="global.html#show">show</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">deprecated/mini-collapsible-popper-positioning.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// Version:         1.0.2

// Changes:         1.0.2 | Added ability for user to pass config options to popper
//                  constructor

import { createPopper } from '@popperjs/core';

const merge = Object.assign;
const DATA_KEY = "popperInstance";
const defaults = {
  arrowEnabled: true,
  arrowSize: 10,
  placementDataKey: 'cc-placement',
  stradegyDataKey: "cc-stradegy",
  arrowClasses: "cc-arrow",
  popper: {} // options to be merged
};
/**
 * Creates a new set of options, pass modifiers array seperately
 * - Used to reduce complexity of mergining array's of reference object
 * - Instead this function (factory) will create a new object for each modifiers
 *   so there is no possible issues upstream with duplicated references (ie. eventListeners)
 * @param {Object} options Popper options
 * @returns 
 */
function createOptions(options) {
  const modifiers = options.modifiers || [];
  delete options.modifiers;
  return Object.assign({
    modifiers: [
      { 
        name: 'eventListeners', 
        enabled: false 
      },
      {
        name: 'preventOverflow',
        enabled: true,
        options: {
          mainAxis: true
        }
      },
      ...modifiers
    ]
  }, options);
}

/**
 * Creates a popup position mechanism for a collapsible set
 * - Note: if you are adding additional collapsibles to the page you
 *   will need to select them and pass their collaspible elements set to the 
 *   init method provided in this functions return.
 * @param {Object} cc Collapsibles Instance
 * @param {Object} userOptions Options object
 * @param {Boolean} userOptions.arrowEnabled Enable arrow (creates arrow element automatically)
 * @param {Number} userOptions.arrowSize Options object
 * @param {String} userOptions.arrowClasses Classes to be added to the arrow for styling
 * @param {String} userOptions.placementDataKey Data attribute to be selected without "data-", defualts to 'dropdown-placement'
 * @returns {Object} Interface to init new instances added to page, possibly more in the future
 */
export function popperPositioning(cc, options) {
  const userCallback = cc.onChangeAfter;
  // Merge and reassign
  options = merge({}, defaults, options);
  // Prep each collapsible instance available on page
  cc.each(init);
  cc.onChangeAfter = function popperPositioningCb({ toggle }, state) {
    if (userCallback) {
      userCallback.apply(cc, arguments);
    }
    // Popper related
    const isOpen = state === "open";
    const instance = toggle.data(DATA_KEY);
    // Remove current options and change event listeners (enable when open only)
    // This helps performance b/c this plugin watches the page (resize, etc)
    const opts = instance.state.options;
    const eventModifier = opts.modifiers.find(el => el.name === "eventListeners");
    if (eventModifier) {
      eventModifier.enabled = isOpen
    }
    // Reset the options object
    instance.setOptions(opts);
    // Force it to update the positioning now
    if (isOpen) {
      instance.update();
    }
  };

  /**
   * Initialize a single popper/CC instance
   * @param {Object} elements Collapsible elements object
   */
  function init({ toggle, content, container }) {
    // Attempting to reinitialize
    if (toggle.data(DATA_KEY)) {
      return;
    }
    const config = merge({}, { 
      placement: container.data(options.placementDataKey) || "auto", 
      strategy: container.data(options.stradegyDataKey) || "absolute", 
      modifiers: [] 
    }, options.popper);

    // Add optional arrow modifiers
    if (options.arrowEnabled) {
      content.prepend(`&lt;div class="${ options.arrowClasses }" data-popper-arrow>&lt;/div>`);
      config.modifiers.push({
        name: 'offset',
        options: {
          offset: [ 0, options.arrowSize ],
        },
      });
    }
    // Create popper instance and add ref to jQuery element data
    const instance = createPopper(
      toggle.get(0), 
      content.get(0), 
      createOptions(config)
    );
    toggle.data(DATA_KEY, instance);
  }
  /** 
   * Minimal user interface is returned 
   */
  return { init }
}

</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Sun Dec 17 2023 22:55:54 GMT-0500 (Eastern Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
